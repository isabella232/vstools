/***************************************************************************************************
 Copyright (C) 2023 The Qt Company Ltd.
 SPDX-License-Identifier: LicenseRef-Qt-Commercial OR LGPL-3.0-only OR GPL-2.0-only OR GPL-3.0-only
***************************************************************************************************/
//# using System.IO
//# using System.Threading.Tasks
var solutionName = "QtVsTest";
var projectName = "MyGuiApp";
var tempDir = Environment.GetEnvironmentVariable("TEMP");
var solutionFileName = solutionName + ".sln";
var solutionDir = Path.Combine(tempDir, solutionName);
var projectDir = Path.Combine(solutionDir, projectName);
if (Directory.Exists(solutionDir))
    Directory.Delete(solutionDir, recursive: true);
Directory.CreateDirectory(projectDir);
var solution = Dte.Solution as Solution2;
solution.Create(tempDir, solutionName);
solution.SaveAs(Path.Combine(solutionDir, solutionFileName));
var templateGuiApp = solution.GetProjectTemplate("Qt Widgets Application", "VC");
var taskAddProj = Task.Run(() => solution.AddFromTemplate(templateGuiApp, projectDir, "MyGuiApp"));
//# ui context VSROOT 15000 => "Qt Widgets Application Wizard"
//# ui pattern Invoke => "Next >"
//# ui pattern Invoke => "Next >"
//# ui pattern Invoke => "Finish"
if (!taskAddProj.Wait(15000))
    throw new Exception("Timeout: Solution2.AddFromTemplate");
